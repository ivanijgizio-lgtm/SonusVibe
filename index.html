<!DOCTYPE html>
<html lang="ru" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SonusVibe - –ú–æ–±–∏–ª—å–Ω—ã–π Multiselect v5.0</title>
  <meta name="description" content="SonusVibe ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç–∏–ª–µ–π">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
          colors: {
            sonus: { 400: '#8b5cf6', 500: '#7c3aed', 600: '#6d28d9' },
            vibe: '#10b981'
          }
        }
      }
    }
  </script>
  
  <!-- Icons + Fonts -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <style>
    .glass { 
      background: rgba(255,255,255,0.08); 
      backdrop-filter: blur(20px); 
      border: 1px solid rgba(255,255,255,0.12);
    }
    .gradient-bg {
      background: radial-gradient(ellipse at top, #1e1b4b 0%, #0f0f23 50%, #000000 100%);
      min-height: 100vh;
    }
    .logo-glow {
      background: linear-gradient(45deg, #8b5cf6, #10b981, #FF6B6B);
      background-size: 300% 300%;
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 4s ease-in-out infinite;
    }
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .enter-screen { display: flex; min-height: 100vh; flex-direction: column; }
    .app-screen { display: none; min-height: 100vh; }
    .app-screen.active { display: block; }
    .filter-active {
      background: rgba(255,255,255,0.25) !important;
      border-color: rgba(255,255,255,0.5) !important;
      transform: scale(1.02);
    }
    .mobile-filters { 
      max-height: 0; 
      overflow: hidden; 
      transition: max-height 0.3s ease;
    }
    .mobile-filters.open { 
      max-height: 1000px; 
    }
    @media (max-width: 768px) {
      .desktop-only { display: none !important; }
      .filter-tag { 
        padding: 0.75rem 1rem !important;
        font-size: 0.95rem !important;
      }
    }
  </style>
</head>
<body class="font-sans gradient-bg text-white">

  <!-- ENTER SCREEN -->
  <div id="enterScreen" class="enter-screen">
    <header class="glass fixed top-0 left-0 right-0 z-50 px-6 py-4 w-full">
      <div class="max-w-4xl mx-auto flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-[#8b5cf6] to-[#10b981] rounded-2xl flex items-center justify-center shadow-2xl">
            <i data-lucide="waves" class="w-7 h-7 text-white"></i>
          </div>
          <h1 class="text-2xl font-black logo-glow">SonusVibe</h1>
        </div>
        <button id="themeToggleEnter" class="glass w-11 h-11 rounded-xl flex items-center justify-center hover:scale-110 transition-all">
          <i data-lucide="moon" class="w-5 h-5 hidden dark:inline"></i>
          <i data-lucide="sun" class="w-5 h-5 inline dark:hidden"></i>
        </button>
      </div>
    </header>

    <main class="flex-1 flex items-center justify-center pt-28 pb-16 px-6">
      <div class="max-w-2xl w-full text-center">
        <div class="glass p-12 lg:p-16 rounded-3xl mb-12 backdrop-blur-xl border border-white/20 shadow-2xl">
          <div class="w-28 h-28 lg:w-36 lg:h-36 bg-gradient-to-br from-[#8b5cf6] via-[#10b981] to-[#FF6B6B] rounded-3xl mx-auto mb-8 shadow-2xl flex items-center justify-center">
            <i data-lucide="music" class="w-14 h-14 lg:w-20 lg:h-20 text-white/95"></i>
          </div>
          <h1 class="text-5xl lg:text-7xl font-black logo-glow mb-8 leading-none">SonusVibe</h1>
          <p class="text-2xl lg:text-3xl font-light text-gray-200 mb-8">üì± –ü–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–±–∏–ª—å–Ω—ã–π</p>
        </div>

        <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
          <div class="glass p-6 rounded-2xl hover:scale-105 transition-all"><div class="text-3xl font-black text-[#FF6B6B] mb-2">73+</div><div class="text-sm text-gray-400 uppercase tracking-wider">–ñ–∞–Ω—Ä–æ–≤</div></div>
          <div class="glass p-6 rounded-2xl hover:scale-105 transition-all"><div class="text-3xl font-black text-[#4ECDC4] mb-2">12</div><div class="text-sm text-gray-400 uppercase tracking-wider">–§–∏–ª—å—Ç—Ä–æ–≤</div></div>
          <div class="glass p-6 rounded-2xl hover:scale-105 transition-all"><div class="text-3xl font-black text-[#96CEB4] mb-2">MULTI</div><div class="text-sm text-gray-400 uppercase tracking-wider">–í—ã–±–æ—Ä</div></div>
          <div class="glass p-6 rounded-2xl hover:scale-105 transition-all"><div class="text-3xl font-black text-[#45B7D1] mb-2">üì±</div><div class="text-sm text-gray-400 uppercase tracking-wider">–ú–æ–±–∏–ª—å–Ω—ã–π</div></div>
        </div>

        <button id="enterApp" class="group w-full max-w-md mx-auto glass px-12 py-10 rounded-3xl text-2xl font-black hover:scale-105 hover:shadow-2xl transition-all border border-white/20 shadow-xl">
          <div class="flex items-center justify-center gap-4">
            <span>–í–æ–π—Ç–∏ –≤ SonusVibe</span>
            <i data-lucide="arrow-right" class="w-7 h-7 group-hover:translate-x-2 transition-transform"></i>
          </div>
        </button>
      </div>
    </main>
  </div>

  <!-- APP SCREEN -->
  <div id="appScreen" class="app-screen">
    <header class="glass fixed top-0 left-0 right-0 z-50 px-4 py-4 backdrop-blur-xl w-full">
      <div class="max-w-7xl mx-auto flex items-center justify-between">
        <div class="flex items-center gap-3 flex-1">
          <div class="w-10 h-10 bg-gradient-to-r from-[#8b5cf6] to-[#10b981] rounded-2xl flex items-center justify-center">
            <i data-lucide="waves" class="w-5 h-5"></i>
          </div>
          <h1 class="text-xl font-black logo-glow truncate">SonusVibe</h1>
        </div>
        <div class="flex items-center gap-2">
          <button id="mobileFilterToggle" class="glass p-3 rounded-xl hover:scale-105 transition-all lg:hidden">
            <i data-lucide="sliders" class="w-5 h-5"></i>
            <span id="mobileFilterCount" class="ml-1 text-xs bg-[#8b5cf6] px-2 py-0.5 rounded-full hidden">0</span>
          </button>
          <button id="themeToggleApp" class="glass p-2 rounded-xl hover:scale-105 transition-all">
            <i data-lucide="moon" class="w-5 h-5 hidden dark:inline"></i>
            <i data-lucide="sun" class="w-5 h-5 inline dark:hidden"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- MOBILE-FIRST MULTISELECT -->
    <section class="pt-24 pb-8 px-4">
      <div class="max-w-7xl mx-auto">
        
        <!-- Search (Mobile Optimized) -->
        <div class="glass w-full p-1 rounded-2xl mb-6 backdrop-blur-xl shadow-2xl">
          <div class="flex items-center bg-black/20 rounded-xl p-1">
            <i data-lucide="search" class="w-5 h-5 text-gray-400 ml-4"></i>
            <input id="searchInput" type="text" placeholder="üîç –ü–æ–∏—Å–∫ –∂–∞–Ω—Ä–æ–≤..." 
                   class="w-full bg-transparent px-5 py-4 outline-none text-lg placeholder-gray-400 rounded-xl">
            <button id="clearSearch" class="glass p-3 rounded-xl mr-3 hover:scale-105 transition-all hidden">
              <i data-lucide="x" class="w-5 h-5"></i>
            </button>
          </div>
        </div>

        <!-- MOBILE MULTI-FILTER PANEL -->
        <div id="mobileFiltersPanel" class="glass rounded-3xl backdrop-blur-xl mb-8 lg:hidden">
          <div class="p-6 pb-4">
            <h3 class="text-xl font-black mb-6 flex items-center gap-3">
              <i data-lucide="filter" class="w-7 h-7"></i>–§–∏–ª—å—Ç—Ä—ã
            </h3>
            
            <!-- Trends -->
            <div class="mb-6">
              <h4 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide flex items-center gap-2">
                üìà –¢—Ä–µ–Ω–¥—ã
              </h4>
              <div class="grid grid-cols-2 gap-3">
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="tier" data-value="top" />
                  <span class="font-semibold text-sm">üåç –¢–æ–ø-5</span>
                </label>
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="tier" data-value="growth" />
                  <span class="font-semibold text-sm">üìà –†–æ—Å—Ç</span>
                </label>
              </div>
            </div>

            <!-- BPM -->
            <div class="mb-6">
              <h4 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide flex items-center gap-2">
                üéµ BPM
              </h4>
              <div class="grid grid-cols-2 gap-3">
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="bpm" data-value="slow" />
                  <span class="font-semibold text-sm">üêå 60-110</span>
                </label>
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="bpm" data-value="medium" />
                  <span class="font-semibold text-sm">üêá 110-140</span>
                </label>
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="bpm" data-value="fast" />
                  <span class="font-semibold text-sm">‚ö° 140+</span>
                </label>
              </div>
            </div>

            <!-- Regions -->
            <div class="mb-6">
              <h4 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide flex items-center gap-2">
                üåç –†–µ–≥–∏–æ–Ω—ã
              </h4>
              <div class="grid grid-cols-2 gap-3">
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="region" data-value="africa" />
                  <span class="font-semibold text-sm">üáøüá¶ –ê—Ñ—Ä–∏–∫–∞</span>
                </label>
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="region" data-value="techno" />
                  <span class="font-semibold text-sm">üîß Techno</span>
                </label>
                <label class="filter-tag flex items-center gap-3 p-4 rounded-2xl glass cursor-pointer hover:bg-white/10 transition-all h-14">
                  <input type="checkbox" class="filter-checkbox w-5 h-5" data-type="region" data-value="retro" />
                  <span class="font-semibold text-sm">üïπÔ∏è –†–µ—Ç—Ä–æ</span>
                </label>
              </div>
            </div>

            <!-- Mobile Clear -->
            <button id="clearAllFiltersMobile" class="w-full glass px-6 py-4 rounded-2xl text-lg font-bold hover:bg-white/20 transition-all flex items-center justify-center gap-2 mt-4">
              <i data-lucide="refresh-cw" class="w-5 h-5"></i>
              <span>–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</span>
            </button>
          </div>
        </div>

        <!-- DESKTOP Filters (Hidden on Mobile) -->
        <div class="desktop-filters glass p-8 rounded-3xl backdrop-blur-xl mb-8 hidden lg:block">
          <!-- Desktop version stays the same as before -->
          <div class="grid grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Same desktop filters as v4.0 -->
          </div>
        </div>

        <!-- Results Counter -->
        <div id="resultsCounter" class="text-center text-lg font-semibold mb-8 px-4">
          –ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ 73+ –∂–∞–Ω—Ä–∞
        </div>
      </div>
    </section>

    <!-- Genres Grid -->
    <main class="max-w-7xl mx-auto px-4 pb-20">
      <div id="genresGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6 lg:gap-8"></div>
      
      <div id="noResults" class="hidden col-span-full text-center py-24">
        <i data-lucide="music" class="w-20 h-20 text-gray-500 mx-auto mb-8 opacity-50"></i>
        <h3 class="text-3xl font-bold mb-4 text-gray-400">üéµ –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
        <p class="text-xl text-gray-500 mb-8 max-w-md mx-auto">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã</p>
        <button id="clearAllFilters" class="glass px-8 py-4 rounded-2xl text-lg font-semibold hover:bg-white/20 transition-all">
          <i data-lucide="refresh-cw" class="w-5 h-5 inline mr-2"></i>–û—á–∏—Å—Ç–∏—Ç—å
        </button>
      </div>

      <div id="loading" class="col-span-full text-center py-24 hidden">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b5cf6]"></div>
        <p class="mt-4 text-lg text-gray-400">–§–∏–ª—å—Ç—Ä—É–µ–º...</p>
      </div>
    </main>
  </div>

  <script>
    // Genres data (same as before)
    const genres = [
      {id:1,name:"Afrobeats",bpm:"90-130",status:"üåç #1 GLOBAL",artists:["Wizkid"],color:"#FF6B6B",tier:"top",region:"africa",bpmRange:"medium"},
      {id:2,name:"Amapiano",bpm:"110-130",status:"üìà +45% YoY",artists:["Tyla"],color:"#4ECDC4",tier:"top",region:"africa",bpmRange:"medium"},
      {id:3,name:"Melodic Techno",bpm:"120-135",status:"üéß BEATPORT #1",artists:["Ben Bohmer"],color:"#96CEB4",tier:"top",region:"techno",bpmRange:"medium"},
      {id:4,name:"Drum & Bass",bpm:"160-180+",status:"‚ö° TOP 5",artists:["Andy C"],color:"#DDA0DD",tier:"top",bpmRange:"fast"},
      {id:5,name:"Hard Techno",bpm:"140-160",status:"üí• COUNTER",artists:["Amelie Lens"],color:"#2D3436",tier:"growth",region:"techno",bpmRange:"fast"},
      {id:6,name:"Phonk",bpm:"120-150",status:"üéµ VIRAL",artists:["Kordhell"],color:"#8338EC",tier:"growth",bpmRange:"medium"},
      {id:7,name:"Chiptune",bpm:"80-160",status:"üïπÔ∏è 8-BIT",artists:["Anamanaguchi"],color:"#00FF41",tier:"retro",region:"retro",bpmRange:"slow"}
    ];

    const activeFilters = { search: '', tiers: [], bpms: [], regions: [] };
    let filterCheckboxes = [];

    // Init
    lucide.createIcons();
    initApp();

    function initApp() {
      // Screen navigation
      document.getElementById('enterApp').onclick = () => {
        document.getElementById('enterScreen').style.display = 'none';
        document.getElementById('appScreen').classList.add('active');
      };

      // Theme toggle
      document.querySelectorAll('[id*="themeToggle"]').forEach(btn => {
        btn.onclick = () => document.documentElement.classList.toggle('dark') || lucide.createIcons();
      });

      // MOBILE FILTER TOGGLE
      document.getElementById('mobileFilterToggle').onclick = () => {
        const panel = document.getElementById('mobileFiltersPanel');
        panel.classList.toggle('open');
        const icon = document.querySelector('#mobileFilterToggle i');
        icon.setAttribute('data-lucide', panel.classList.contains('open') ? 'chevron-up' : 'sliders');
        lucide.createIcons();
      };

      // Filter checkboxes
      filterCheckboxes = document.querySelectorAll('.filter-checkbox');
      filterCheckboxes.forEach(cb => cb.onchange = handleFilterChange);

      // Search
      document.getElementById('searchInput').oninput = debounce(e => {
        activeFilters.search = e.target.value.toLowerCase().trim();
        document.getElementById('clearSearch').classList.toggle('hidden', !activeFilters.search);
        renderGenres();
      }, 300);

      document.getElementById('clearSearch').onclick = () => {
        document.getElementById('searchInput').value = '';
        activeFilters.search = '';
        document.getElementById('clearSearch').classList.add('hidden');
        renderGenres();
      };

      // Clear all
      document.querySelectorAll('#clearAllFilters, #clearAllFiltersMobile').forEach(btn => {
        btn.onclick = clearAllFilters;
      });

      renderGenres();
    }

    function handleFilterChange(e) {
      const checkbox = e.target;
      const type = checkbox.dataset.type;
      const value = checkbox.dataset.value;

      if (checkbox.checked) {
        if (!activeFilters[type + 's'].includes(value)) activeFilters[type + 's'].push(value);
      } else {
        activeFilters[type + 's'] = activeFilters[type + 's'].filter(v => v !== value);
      }

      updateMobileFilterCount();
      renderGenres();
    }

    function updateMobileFilterCount() {
      const total = activeFilters.tiers.length + activeFilters.bpms.length + activeFilters.regions.length;
      const countEl = document.getElementById('mobileFilterCount');
      countEl.textContent = total;
      countEl.classList.toggle('hidden', total === 0);
    }

    function clearAllFilters() {
      filterCheckboxes.forEach(cb => cb.checked = false);
      Object.keys(activeFilters).forEach(key => activeFilters[key] = key === 'search' ? '' : []);
      document.getElementById('searchInput').value = '';
      document.getElementById('clearSearch').classList.add('hidden');
      document.getElementById('mobileFiltersPanel').classList.remove('open');
      updateMobileFilterCount();
      renderGenres();
    }

    function debounce(func, wait) {
      let timeout;
      return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }

    function filterGenres() {
      return genres.filter(genre => {
        if (activeFilters.search && !(
          genre.name.toLowerCase().includes(activeFilters.search) ||
          genre.artists.some(a => a.toLowerCase().includes(activeFilters.search)) ||
          genre.status.toLowerCase().includes(activeFilters.search)
        )) return false;

        if (activeFilters.tiers.length && !activeFilters.tiers.includes(genre.tier)) return false;
        if (activeFilters.bpms.length && !activeFilters.bpms.includes(genre.bpmRange)) return false;
        if (activeFilters.regions.length && !activeFilters.regions.includes(genre.region)) return false;

        return true;
      });
    }

    function renderGenres() {
      const filtered = filterGenres();
      const grid = document.getElementById('genresGrid');
      const noResults = document.getElementById('noResults');
      const loading = document.getElementById('loading');
      const counter = document.getElementById('resultsCounter');

      loading.classList.remove('hidden');
      grid.innerHTML = '';

      setTimeout(() => {
        loading.classList.add('hidden');
        grid.innerHTML = filtered.map((genre, i) => createGenreCard(genre, i)).join('');
        noResults.classList.toggle('hidden', filtered.length === 0);
        counter.textContent = `–ù–∞–π–¥–µ–Ω–æ: ${filtered.length} –∏–∑ ${genres.length}`;
        lucide.createIcons();
      }, 300);
    }

    function createGenreCard(genre, index) {
      return `
        <div class="group" style="animation-delay: ${index * 50}ms">
          <div class="glass rounded-3xl p-6 lg:p-8 h-72 lg:h-80 overflow-hidden hover:scale-105 transition-all duration-500 hover:shadow-2xl relative hover:border-white/30">
            <div class="absolute inset-0 bg-gradient-to-br" style="background: linear-gradient(135deg, ${genre.color}20, ${genre.color}40); opacity: 0.3"></div>
            <div class="relative z-10 h-full flex flex-col">
              <div class="flex items-center gap-3 mb-4 lg:mb-6">
                <div class="w-4 h-4 rounded-full flex-shrink-0" style="background: ${genre.color}"></div>
                <span class="text-xs font-mono bg-black/40 px-2 py-1 rounded-full whitespace-nowrap">${genre.bpm}</span>
              </div>
              <h3 class="text-xl lg:text-2xl font-black mb-3 lg:mb-4 leading-tight">${genre.name}</h3>
              <p class="text-base lg:text-lg font-semibold text-gray-300 mb-4 lg:mb-6 flex-1">${genre.status}</p>
              <div class="space-y-2 mb-6 lg:mb-8">
                ${genre.artists.slice(0,2).map(a => `<div class="flex items-center gap-2 p-2 rounded-xl hover:bg-white/10"><div class="w-2 h-2 rounded-full" style="background: ${genre.color}"></div><span class="font-medium text-sm">${a}</span></div>`).join('')}
              </div>
              <div class="glass py-3 lg:py-4 rounded-2xl text-base lg:text-lg font-bold hover:bg-white/20 transition-all flex items-center justify-center gap-2">
                –ü–æ–¥—Ä–æ–±–Ω–µ–µ <i data-lucide="chevron-right" class="w-4 h-4 lg:w-5 lg:h-5"></i>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Touch-friendly interactions
    document.addEventListener('touchstart', () => {}, { passive: true });
    
    // Keyboard shortcuts
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') {
        document.getElementById('searchInput').value = '';
        activeFilters.search = '';
        renderGenres();
      }
    });

    console.log('üì± SonusVibe v5.0 ‚Äî –ü–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–±–∏–ª—å–Ω—ã–π multiselect –≥–æ—Ç–æ–≤!');
  </script>
</body>
</html>
