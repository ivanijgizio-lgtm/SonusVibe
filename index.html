<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SonusVibe — Music Genres</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">

  <style>
    * {margin:0;padding:0;box-sizing:border-box;}
    :root {
      --bg:#0b0b12;
      --card:#11121a;
      --surface:rgba(255,255,255,0.06);
      --border:rgba(255,255,255,0.08);
      --text:#f6f7ff;
      --muted:#a2a4c5;
      --accent:#7c3aed;
      --accent2:#22d3ee;
      --radius:16px;
      --shadow:0 18px 40px rgba(0,0,0,.35);
    }
    body {
      font-family:"Plus Jakarta Sans",sans-serif;
      background:radial-gradient(1200px 600px at 20% -10%, rgba(124,58,237,0.2), transparent 60%),
                 radial-gradient(1000px 600px at 100% 0%, rgba(34,211,238,0.18), transparent 60%),
                 var(--bg);
      color:var(--text);
    }
    h1,h2,h3,.logo{font-family:"Space Grotesk",sans-serif;}
    .hidden{display:none!important;}
    .container{max-width:1200px;margin:0 auto;padding:0 2rem;}
    .header{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(10,10,18,0.8);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:1rem 0;}
    .nav{display:flex;justify-content:space-between;align-items:center;}
    .logo{font-size:1.6rem;font-weight:700;background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .btn{border:1px solid var(--border);background:var(--surface);color:var(--text);padding:.7rem 1.4rem;border-radius:12px;cursor:pointer;font-weight:600;transition:.2s;}
    .btn:hover{transform:translateY(-1px);border-color:var(--accent);}
    .btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;color:white;box-shadow:0 10px 30px rgba(124,58,237,.3);}
    .hero{padding-top:140px;text-align:center;}
    .hero-title{font-size:clamp(2.5rem,6vw,4rem);font-weight:700;}
    .hero-subtitle{color:var(--muted);max-width:700px;margin:1rem auto 2rem;}
    .panel{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:2rem;backdrop-filter:blur(10px);position:relative;z-index:2;}
    .input,.select{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:.9rem 1.2rem;color:var(--text);width:100%;pointer-events:auto;user-select:text;}
    .search-box{display:grid;grid-template-columns:1fr auto;gap:.8rem;}
    .filter-options{display:flex;gap:.7rem;flex-wrap:wrap;}
    .filter-tag{padding:.5rem 1rem;border-radius:999px;border:1px solid var(--border);background:transparent;color:var(--text);cursor:pointer;font-size:.85rem;}
    .filter-tag.active{background:var(--accent);border-color:var(--accent);}
    .genres-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem;}
    .genre-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;box-shadow:var(--shadow);transition:.2s;position:relative;overflow:hidden;}
    .genre-card:hover{transform:translateY(-3px);border-color:var(--accent);}
    .card-cover{
      height:140px;border-radius:12px;background-size:cover;background-position:center;margin-bottom:1rem;
      display:flex;align-items:end;padding:0.8rem;
      background-image:linear-gradient(135deg,rgba(124,58,237,.35),rgba(34,211,238,.25));
    }
    .card-cover .tag{background:rgba(0,0,0,.4);padding:.3rem .7rem;border-radius:999px;font-size:.75rem;}
    .genre-title{font-size:1.2rem;font-weight:700;margin-bottom:.4rem;}
    .meta{color:var(--muted);font-size:.85rem;}
    .chips{display:flex;flex-wrap:wrap;gap:.4rem;margin:.8rem 0;}
    .chip{padding:.35rem .7rem;border-radius:999px;border:1px solid var(--border);font-size:.75rem;color:var(--muted);}
    @media(max-width:768px){.search-box{grid-template-columns:1fr;}}
  </style>
</head>
<body>

<header class="header">
  <div class="container nav">
    <div class="logo">SonusVibe</div>
    <button id="togglePageBtn" class="btn btn-primary">Launch App</button>
  </div>
</header>

<section id="landingPage">
  <div class="container hero">
    <h1 class="hero-title">Music Genres Explorer</h1>
    <p class="hero-subtitle">Электронный справочник жанров с историей, примерами и структурой треков.</p>
    <button id="ctaButton" class="btn btn-primary">Explore Now</button>
  </div>
</section>

<section id="appPage" class="hidden">
  <div class="container" style="padding-top:120px">
    <button id="backBtn" class="btn">← Back</button>

    <div class="panel">
      <h2>Search</h2>
      <div class="search-box" style="margin-top:1rem;">
        <input id="searchInput" type="search" class="input" placeholder="Amapiano, Techno..." autocomplete="off" />
        <button id="searchBtn" class="btn btn-primary">Search</button>
      </div>
    </div>

    <div class="panel">
      <h3>Filters</h3>
      <div class="filter-options" style="margin:.7rem 0;">
        <button class="filter-tag active" data-group="trend" data-filter="all">All</button>
        <button class="filter-tag" data-group="trend" data-filter="top">Top</button>
        <button class="filter-tag" data-group="trend" data-filter="growth">Growth</button>
      </div>
      <div class="filter-options">
        <button class="filter-tag active" data-group="bpm" data-filter="all">Any BPM</button>
        <button class="filter-tag" data-group="bpm" data-filter="slow">60–110</button>
        <button class="filter-tag" data-group="bpm" data-filter="medium">110–140</button>
        <button class="filter-tag" data-group="bpm" data-filter="fast">140+</button>
      </div>
      <button id="clearBtn" class="btn" style="margin-top:1rem;">Clear</button>
    </div>

    <div id="resultsText" style="margin-bottom:1rem;color:var(--muted);"></div>
    <div id="genresContainer" class="genres-grid"></div>
    <div id="noResults" class="hidden">Нет результатов</div>
  </div>
</section>

<script>
  let genresData = [];
  let filteredGenres = [];
  let activeFilters = { trend:"all", bpm:"all" };
  const el = id => document.getElementById(id);

  async function loadGenres() {
    try {
      const res = await fetch('data/genres.json');
      if (!res.ok) throw new Error('Файл не найден');
      genresData = await res.json();
    } catch (e) {
      console.warn('Не удалось загрузить genres.json, использую fallback');
      genresData = [
        {
          id:"amapiano",
          name:"Amapiano",
          bpm:"110-130",
          tier:"growth",
          bpmRange:"medium",
          subgenres:["Log Drum","Sgija"],
          description:"ЮАР-пиано-хаус.",
          image:"https://images.unsplash.com/photo-1459749411175-04bf5292ceea?auto=format&fit=crop&w=800&q=60",
          audio:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
          video:"https://www.w3schools.com/html/mov_bbb.mp4"
        }
      ];
    }
    filteredGenres = [...genresData];
    renderGenres(genresData);
  }

  loadGenres();

  el('togglePageBtn').onclick = showApp;
  el('ctaButton').onclick = showApp;
  el('backBtn').onclick = showLanding;
  el('searchBtn').onclick = handleSearch;
  el('searchInput').oninput = handleSearch;
  el('clearBtn').onclick = clearFilters;

  document.querySelectorAll('.filter-tag').forEach(tag=>{
    tag.onclick = ()=>applyFilter(tag);
  });

  function showApp(){el('landingPage').classList.add('hidden');el('appPage').classList.remove('hidden');}
  function showLanding(){el('appPage').classList.add('hidden');el('landingPage').classList.remove('hidden');}

  function handleSearch(){
    const term = el('searchInput').value.toLowerCase().trim();
    filteredGenres = term ? genresData.filter(g=>g.name.toLowerCase().includes(term) || (g.description||"").toLowerCase().includes(term)) : [...genresData];
    applyFilters();
  }

  function applyFilter(tag){
    const group = tag.dataset.group;
    document.querySelectorAll(`.filter-tag[data-group="${group}"]`).forEach(t=>t.classList.remove('active'));
    tag.classList.add('active');
    activeFilters[group] = tag.dataset.filter;
    applyFilters();
  }

  function applyFilters(){
    let result = [...filteredGenres];
    if(activeFilters.trend !== "all") result = result.filter(g=>g.tier === activeFilters.trend);
    if(activeFilters.bpm !== "all") result = result.filter(g=>g.bpmRange === activeFilters.bpm);
    renderGenres(result);
  }

  function clearFilters(){
    activeFilters = { trend:"all", bpm:"all" };
    document.querySelectorAll('.filter-tag').forEach(t=>t.classList.remove('active'));
    document.querySelector('.filter-tag[data-group="trend"][data-filter="all"]').classList.add('active');
    document.querySelector('.filter-tag[data-group="bpm"][data-filter="all"]').classList.add('active');
    el('searchInput').value = "";
    filteredGenres = [...genresData];
    renderGenres(genresData);
  }

  function renderGenres(genres){
    const container = el('genresContainer');
    container.innerHTML = "";
    el('resultsText').textContent = `Показано ${genres.length} из ${genresData.length}`;
    if(!genres.length){el('noResults').classList.remove('hidden');return;}
    el('noResults').classList.add('hidden');

    genres.forEach(g=>{
      const card = document.createElement('div');
      card.className="genre-card";
      card.innerHTML=`
        <div class="card-cover" style="background-image:url('${g.image||''}')">
          <span class="tag">${g.bpm||'BPM'}</span>
        </div>

        <div class="genre-title">${g.name}</div>
        <div class="meta">${g.description||''}</div>

        <div class="chips">
          ${(g.subgenres||[]).slice(0,4).map(s=>`<span class="chip">${s}</span>`).join("")}
        </div>

        ${g.audio ? `<div style="margin-top:10px;"><audio controls style="width:100%"><source src="${g.audio}" type="audio/mpeg"></audio></div>` : ""}

        ${g.video ? `<div style="margin-top:10px;"><video controls style="width:100%;border-radius:12px;"><source src="${g.video}" type="video/mp4"></video></div>` : ""}
      `;
      container.appendChild(card);
    });
  }
</script>
</body>
</html>
